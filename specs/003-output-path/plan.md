# Implementation Plan: Chemin de Destination Personnalisé

**Branch**: `003-output-path` | **Date**: 2025-12-09 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/003-output-path/spec.md`

## Summary

Ajouter un argument CLI optionnel `--path` / `-p` permettant de spécifier le chemin de destination pour la génération du projet. Par défaut, le projet est généré dans le dossier courant, préservant la rétrocompatibilité. Le système doit résoudre les chemins relatifs, absolus et avec tilde, valider les permissions d'écriture, et créer les dossiers intermédiaires si nécessaire.

## Technical Context

**Language/Version**: Python >= 3.10
**Primary Dependencies**: questionary >= 2.0.0, rich >= 13.0.0, argparse (stdlib)
**Storage**: N/A (génération de fichiers sur le système de fichiers)
**Testing**: Tests manuels selon quickstart.md (tests automatisés à venir)
**Target Platform**: Linux (principalement), macOS compatible
**Project Type**: Single CLI project
**Performance Goals**: N/A (opération ponctuelle)
**Constraints**: Doit fonctionner sans accès réseau, validation avant génération
**Scale/Scope**: Impact limité à cli.py et generator.py

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principe | Statut | Justification |
|----------|--------|---------------|
| I. Simplicité et Minimalisme | ✅ PASS | Un seul argument optionnel, utilise pathlib (stdlib), pas de nouvelle dépendance |
| II. Configuration-Driven | ✅ PASS | Reste cohérent - l'argument CLI est une entrée utilisateur, pas une configuration |
| III. Template-Based Generation | ✅ PASS | Aucun impact sur les templates |
| IV. Expérience Utilisateur Interactive | ✅ PASS | Chemin affiché dans le récapitulatif, messages d'erreur clairs |
| V. Sécurité First | ✅ PASS | Validation des permissions avant génération, pas de secrets exposés |

**Verdict**: Tous les principes respectés. Pas de violation.

## Project Structure

### Documentation (this feature)

```text
specs/003-output-path/
├── plan.md              # This file
├── research.md          # Technical research on path handling
├── data-model.md        # Changes to ProjectConfig and CLI
├── quickstart.md        # Test scenarios
└── tasks.md             # Generated by /speckit.tasks
```

### Source Code (repository root)

```text
src/projinit/
├── cli.py          → Ajout argument --path/-p, validation, affichage
├── generator.py    → Aucune modification (target_dir déjà en paramètre)
└── validators.py   → Potentielle nouvelle fonction validate_output_path()
```

**Structure Decision**: Modifications minimales sur cli.py, pas de nouveau module. La logique de validation du chemin peut être ajoutée inline ou dans validators.py selon la complexité.

## Complexity Tracking

> Pas de violation de la Constitution - tableau non requis.

## Implementation Approach

### Key Technical Decisions

1. **Parsing des arguments**: Utiliser `argparse` existant, ajouter `--path` / `-p` comme argument optionnel
2. **Résolution des chemins**: Utiliser `Path.expanduser()` pour le tilde, `Path.resolve()` pour les chemins relatifs
3. **Validation**: Vérifier permissions d'écriture avec `os.access()` sur le chemin parent
4. **Création des dossiers**: Utiliser `Path.mkdir(parents=True, exist_ok=True)` déjà en place

### Files to Modify

| Fichier | Modifications |
|---------|---------------|
| `src/projinit/cli.py` | Ajouter argument `--path`, résoudre le chemin, afficher dans summary |
| `src/projinit/validators.py` | (optionnel) Ajouter `validate_output_path()` |

### Dependencies

- Aucune nouvelle dépendance requise
- Utilise `pathlib` et `os` de la stdlib Python

## Next Steps

1. Consulter [research.md](./research.md) pour les détails techniques sur la gestion des chemins
2. Consulter [data-model.md](./data-model.md) pour les modifications du modèle de données
3. Consulter [quickstart.md](./quickstart.md) pour les scénarios de test
4. Exécuter `/speckit.tasks` pour générer les tâches d'implémentation
